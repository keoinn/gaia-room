import{E as q,ab as X,P as Q,a4 as Z,af as ee,c as C,r as m,_ as v,k as r,w as J,o as te,Y as ae,e as V,f as oe,g as d,N as i,ao as f,z as se,A as le,q as U,u as ne,x as Y,m as re}from"./index-Zs_uUSd6.js";import{E as ie,c as ce,a as W,S as de,P as ue,C as me,p as ve,V as I}from"./preprocessor-BMlkFtbV.js";import{f as pe,A as be,V as h}from"./VBtn-BVmANKO0.js";import ge from"./keyboard_shortcuts-BfflGstq.js";import{c as fe,u as he,V as H,f as ke}from"./forwardRefs-CF15GdgT.js";import{a as Se}from"./tag-zkPujd5b.js";import"./plugin-vueexport-helper-DlAUqK2U.js";const $=(a,e,l)=>{e.aspect=a.clientWidth/a.clientHeight,e.updateProjectionMatrix(),l.setSize(a.clientWidth,a.clientHeight),l.setPixelRatio(window.devicePixelRatio)};class ye{constructor(e,l,o){$(e,l,o),window.addEventListener("resize",()=>{$(e,l,o),this.onResize()})}onResize(){}}class we extends ie{constructor(e){super(e),console.log(this.CelestialObjects);const l=ce(),o=W("sun"),u=W("ambient");[o,u,l].forEach(p=>{this.scene.add(p)}),this.generateObjects([de]),this.generateObjects(ue),new ye(e,this.camera,this.renderer)}generateObjects(e){return e.forEach(l=>{const o=new me(this.scene,this.camera,l,this.labelRenderer);console.log("Created",o.name),this.scene.add(o.container),l.name.toUpperCase()!=="SUN"&&this.loop.updatables.push(o.container),this.CelestialObjects.push(o)})}clearTrace(){this.CelestialObjects.forEach(e=>{e.trace=[]})}toggleLabels(){this.CelestialObjects.forEach(e=>{e.label.visible=!e.label.visible,this.labelRenderer.render(this.scene,this.camera)})}set OrbitingRecordTrace(e){const l=e===!0;this.CelestialObjects.forEach(o=>{o.isTraced=l,l||(o.trace=[])})}}const Te="/gaia-room/assets/backgroundmusic-DFsQyoa2.wav",xe=q({id:String,text:String,...X(fe({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),k=Q()({name:"VTooltip",props:xe(),emits:{"update:modelValue":a=>!0},setup(a,e){let{slots:l}=e;const o=Z(a,"modelValue"),{scopeId:u}=he(),p=ee(),y=C(()=>a.id||`v-tooltip-${p}`),b=m(),T=C(()=>a.location.split(" ").length>1?a.location:a.location+" center"),x=C(()=>a.origin==="auto"||a.origin==="overlap"||a.origin.split(" ").length>1||a.location.split(" ").length>1?a.origin:a.origin+" center"),P=C(()=>a.transition?a.transition:o.value?"scale-transition":"fade-transition"),_=C(()=>v({"aria-describedby":y.value},a.activatorProps));return Se(()=>{const E=H.filterProps(a);return r(H,v({ref:b,class:["v-tooltip",a.class],style:a.style,id:y.value},E,{modelValue:o.value,"onUpdate:modelValue":g=>o.value=g,transition:P.value,absolute:!0,location:T.value,origin:x.value,persistent:!0,role:"tooltip",activatorProps:_.value,_disableGlobalStack:!0},u),{activator:l.activator,default:function(){var D;for(var g=arguments.length,S=new Array(g),w=0;w<g;w++)S[w]=arguments[w];return((D=l.default)==null?void 0:D.call(l,...S))??a.text}})}),ke({},b)}}),De={id:"timeControl"},Ce={class:"speedControl"},Pe=["disabled"],_e={id:"speedValue"},Ee={class:"info-text"},Ae=["src"],Ve=10,Me="2024-01-01",Oe="2025-01-01",Re="0.05",ze={__name:"SmorreryScene",setup(a){let e;const l=m(),o=m(1),u=m(!1),p=m(!1),y=m(!0),b=m(!1),T=m(!1),x=m(!1),P=m(946728e6);let _,E;const g=m(!1),S=m(!0),w=()=>{u.value=!u.value,u.value?(e.start(),g.value.play()):e.stop()},D=()=>{p.value=!p.value,p.value?e.loop.played=1:e.loop.played=0},M=()=>{y.value=!y.value,y.value?e.loop.timeDirect=1:e.loop.timeDirect=0,e.clearTrace()},O=()=>{b.value=!b.value,e.OrbitingRecordTrace=b.value,console.log(`Trace status = ${b.value}`)};function R(){T.value=!T.value,e.toggleLabels(T.value)}const z=n=>{e.loop.shiftDate=n,e.OrbitingRecordTrace=b.value,e.clearTrace()};J(o,n=>{e.loop.timeScaleRate=n});const G=n=>parseFloat(n),K=n=>{const t=new Date(n);return t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)},A=()=>{S.value=!S.value,g.value.muted=S.value};function L(n){const t=Math.max(.1,Math.min(o.value+n,10));o.value=Math.round(t*100)/100,e.loop.timeScale=o.value,console.log(`Playback speed: ${o.value}x`)}function j(){const n=new Date;z(n),console.log(`Jumped to today's date: ${n}`)}function B(){const n=new Date(Date.UTC(2e3,0,1,12,0,0));z(n),console.log(`Jumped to J2000 date: ${j2000}`)}te(async()=>{try{const n=document.querySelector("#target");e=new we(n),e.start();try{const t=await pe(Ve);console.log("Fetched data:",t.data.data.length,"NEOs."),_=t.data;let s=ve(_);console.log(s),e.generateObjects(s)}catch(t){console.error("Error fetching NEO data:",t)}try{const t=await be(Me,Oe,Re);console.log("Fetched data:",t.data.data.length,"close-approach events."),E=t.data}catch(t){console.error("Error fetching CAD data:",t)}J(e.loop.currentDate_ref,t=>{P.value=t}),g.value.muted=S.value,window.addEventListener("keydown",N)}catch(n){console.error("Error setting up scene or rendering:",n)}}),ae(()=>{window.removeEventListener("keydown",N),e.stop()});function N(n){switch(n.key.toUpperCase()){case"W":e.camera.getWorldDirection(new I),e.camera.position.addScaledVector(e.camera.getWorldDirection(),2);break;case"S":e.camera.getWorldDirection(new I),e.camera.position.addScaledVector(e.camera.getWorldDirection(),-2);break;case"A":e.camera.rotateY(2*Math.PI/180);break;case"D":e.camera.rotateY(-2*Math.PI/180);break;case"L":R();break;case"P":D();break;case"M":A();break;case"T":O();break;case"ENTER":w();break;case"J":L(-.1);break;case"K":L(.1);break;case"R":M();break;case"H":j();break;case"G":B();break;case"M":A();break;case"I":F();break}}const F=()=>{x.value=!x.value};return(n,t)=>(V(),oe("div",{id:"target",ref_key:"target",ref:l},[t[11]||(t[11]=d("div",{id:"info"},null,-1)),d("div",De,[r(k,{bottom:""},{activator:i(({on:s,attrs:c})=>[r(h,v({class:"video-btn text-none"},c,f(s),{onClick:w,text:u.value===!0?"Stop":"Run",size:"small"}),null,16,["text"])]),default:i(()=>[t[1]||(t[1]=d("span",null,"Start/Stop the scene (Shortcut: S)",-1))]),_:1}),r(k,{bottom:""},{activator:i(({on:s,attrs:c})=>[r(h,v({class:"video-btn"},c,f(s),{disabled:!u.value,icon:p.value===!0?"mdi-pause":"mdi-play",onClick:D,size:"small"}),null,16,["disabled","icon"])]),default:i(()=>[t[2]||(t[2]=d("span",null,"Play/Pause (Shortcut: P)",-1))]),_:1}),r(k,{bottom:""},{activator:i(({on:s,attrs:c})=>[r(h,v({class:"video-btn"},c,f(s),{disabled:!u.value,icon:y.value===!0?"mdi-skip-backward":"mdi-skip-forward",onClick:M,size:"small"}),null,16,["disabled","icon"])]),default:i(()=>[t[3]||(t[3]=d("span",null,"Forward/Backward (Shortcut: F)",-1))]),_:1}),r(k,{bottom:""},{activator:i(({on:s,attrs:c})=>[r(h,v({class:"video-btn text-none"},c,f(s),{disabled:!u.value||!p.value,"prepend-icon":b.value===!0?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",onClick:O,text:"Trace",size:"small"}),null,16,["disabled","prepend-icon"])]),default:i(()=>[t[4]||(t[4]=d("span",null,"Toggle trace (Shortcut: T)",-1))]),_:1}),r(k,{bottom:""},{activator:i(({on:s,attrs:c})=>[r(h,v({class:"video-btn text-none"},c,f(s),{disabled:!u.value||!p.value,"prepend-icon":T.value===!0?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",onClick:R,text:"Label",size:"small"}),null,16,["disabled","prepend-icon"])]),default:i(()=>[t[5]||(t[5]=d("span",null,"Toggle labels (Shortcut: L)",-1))]),_:1}),r(k,{bottom:""},{activator:i(({on:s,attrs:c})=>[r(h,v({class:"video-btn text-none"},c,f(s),{disabled:!u.value,text:"J2000",size:"small",onClick:B}),null,16,["disabled"])]),default:i(()=>[t[6]||(t[6]=d("span",null,"Jump to J2000 (Shortcut: G)",-1))]),_:1}),r(k,{bottom:""},{activator:i(({on:s,attrs:c})=>[r(h,v({class:"video-btn text-none"},c,f(s),{disabled:!u.value,text:"Today",size:"small",onClick:j}),null,16,["disabled"])]),default:i(()=>[t[7]||(t[7]=d("span",null,"Jump to Today (Shortcut: H)",-1))]),_:1}),d("div",Ce,[t[8]||(t[8]=d("label",{for:"speedSlider"},"Speed:",-1)),se(d("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value=s),type:"range",id:"speedSlider",min:"0.1",max:"10",step:"0.01",disabled:!u.value},null,8,Pe),[[le,o.value]]),d("span",_e,U(G(o.value))+"x",1)]),d("span",Ee,U(K(P.value)),1),r(k,{bottom:""},{activator:i(({on:s,attrs:c})=>[r(h,v({class:"video-btn"},c,f(s),{icon:S.value?"mdi-volume-off":"mdi-volume-high",onClick:A,size:"small"}),null,16,["icon"])]),default:i(()=>[t[9]||(t[9]=d("span",null,"Toggle mute (Shortcut: M)",-1))]),_:1}),r(k,{bottom:""},{activator:i(({on:s,attrs:c})=>[r(h,v({class:"video-btn"},c,f(s),{icon:"mdi-information",size:"small",onClick:F}),null,16)]),default:i(()=>[t[10]||(t[10]=d("span",null,"Show keyboard shortcuts (Shortcut: ?)",-1))]),_:1}),d("audio",{ref_key:"backgroundMusic",ref:g,src:ne(Te),autoplay:"",loop:"",style:{display:"none"}},null,8,Ae)]),x.value?(V(),Y(ge,{key:0})):re("",!0)],512))}},We={__name:"orrery",setup(a){return(e,l)=>(V(),Y(ze))}};export{We as default};
